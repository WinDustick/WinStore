# План объяснения структуры БД Oracle

Этот документ — ваша стратегия для быстрого и ясного объяснения архитектуры базы данных WinStore на Oracle.

### Шаг 1: Начните с Философии (The "Why")

**Ключевая идея:** Наша база данных — это не мозг, а надёжный сейф.

**Что говорить:**
«В основе нашего проекта лежит философия "Абсурдно Идеального Кода", где главное — это разделение ответственности. Поэтому мы приняли ключевое решение: **база данных отвечает только за надёжное хранение, целостность и быстрый доступ к данным.** Вся сложная бизнес-логика (расчеты, скидки, сложные проверки) намеренно вынесена в бэкенд-приложение на Django. Это делает нашу БД чрезвычайно простой, предсказуемой и быстрой».

**Что показать:**
1.  **[ADR-001: Перенос бизнес-логики](../../.github/copilot_memory_bank/adrs/ADR-001_Business_Logic_To_App_Layer.md):** «Вот документ, где мы формально закрепили это решение».

### Шаг 2: Объясните два главных архитектурных паттерна (The "How")

После того как вы объяснили *почему* БД простая, покажите, *как* эта простота достигается на практике.

#### Паттерн №1: Декларативное управление процессами

**Ключевая идея:** Мы описываем бизнес-процессы не кодом, а данными.

**Что говорить:**
«Вместо того чтобы "зашивать" жизненный цикл заказа или платежа в код, мы описываем его прямо в базе данных. У нас есть:
1.  **Таблицы-справочники статусов** (например, `OrderStatusTypes`), где хранятся все возможные статусы.
2.  **Таблицы переходов** (например, `OrderStatusTransitions`), которые декларативно описывают, из какого статуса в какой можно перейти.

Это делает бизнес-логику наглядной, легко изменяемой без переписывания кода и самодокументируемой».

**Что показать:**
1.  **[ADR-006: Декларативное определение переходов](../../.github/copilot_memory_bank/adrs/ADR-006_Status_Transition_Tables.md):** «Вот решение, объясняющее этот подход».
2.  **Файл `oracle/01_schema/03_status_transitions.sql`:** «А вот так это выглядит вживую — простая таблица, описывающая граф состояний».

#### Паттерн №2: Методичная адаптация под Oracle

**Ключевая идея:** Мы не "изобретали велосипед", а системно адаптировали стандартные практики MS SQL к Oracle.

**Что говорить:**
«Проект изначально поддерживал MS SQL, поэтому для Oracle мы провели методичную адаптацию, сохраняя логику. Ключевые замены:
*   `IDENTITY` → `SEQUENCE` + `TRIGGER` для автоинкремента.
*   `NVARCHAR` → `NVARCHAR2`.
*   `DATETIME` → `TIMESTAMP`.
*   `GO` → убрали, так как это специфично для MS SQL.

Это показывает, что мы не просто скопировали скрипты, а осознанно применили идиоматичные для Oracle решения».

**Что показать:**
1.  **Файл `oracle/docs/README.md`:** «Здесь перечислены все ключевые изменения при миграции. Это наша "карта адаптации"».
2.  **Файл `oracle/01_schema/01_core_schema.sql`:** Покажите пример создания `SEQUENCE` и `TRIGGER` для любой таблицы.

### Шаг 3: Покажите структуру файлов (The "What")

**Ключевая идея:** Структура папок — это и есть план развертывания БД.

**Что говорить:**
«Чтобы понять всю структуру БД, достаточно посмотреть на папку `oracle/`. Её структура организована как пошаговое руководство:
*   `deploy.sql` — главный скрипт, который запускает всё по порядку.
*   `01_schema/` — здесь создается "скелет": таблицы, последовательности, триггеры.
*   `02_audit/` — настройка аудита и безопасности.
*   `03_views/` — представления для упрощения запросов.
*   `04_procedures/` и `05_triggers/` — минимальное количество процедурного кода, только там, где это абсолютно необходимо (например, для генерации ID).

Эта структура делает базу данных предсказуемой и легкой для понимания».

**Что показать:**
*   Просто откройте дерево папок `oracle/` и пройдитесь по нему, комментируя назначение каждой директории.

### Итог для слушателя:

После вашего объяснения у человека в голове должна остаться простая и ясная картина:
1.  **Философия:** БД — это хранилище, логика — в приложении.
2.  **Главные "фишки":** Статусы и переходы описаны как данные; для Oracle применены стандартные аналоги MS SQL.
3.  **Структура:** Файлы организованы в папки по порядку их выполнения, что служит живой документацией.

Этот подход позволит вам уложиться в 5-10 минут и оставить впечатление хорошо спроектированной и документированной системы.
