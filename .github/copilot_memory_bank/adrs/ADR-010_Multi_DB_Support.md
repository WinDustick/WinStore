# ADR-010: Поддержка нескольких СУБД (Multi-DB Support)

## Статус

Принято (2025-10-18)

## Контекст

Изначально проект был нацелен на использование MS SQL Server. В процессе развития возникла потребность в добавлении поддержки Oracle Database для расширения опыта работы с различными СУБД и повышения гибкости проекта. Это потребовало выработки четкой стратегии по управлению двумя разными реализациями базы данных в рамках одной кодовой базы.

## Принятое решение

Проект официально поддерживает две СУБД: **MS SQL Server** и **Oracle Database**.

1.  **Изоляция реализаций:** Все артефакты, специфичные для конкретной СУБД, изолированы в отдельных каталогах:
    *   `sql/`: Код, скрипты и документация для MS SQL.
    *   `oracle/`: Код, скрипты и документация для Oracle.

2.  **Самодостаточные каталоги:** Каждый из этих каталогов является самодостаточным и содержит собственную, специфичную для реализации документацию, включая руководства по стилю и локальные архитектурные решения (ADR).

3.  **Выбор СУБД через конфигурацию:** Бэкенд-приложение (Django) переключается между базами данных с помощью переменной окружения `DB_TYPE` (`mssql` или `oracle`), которая определяет, какой набор настроек подключения использовать.

## Обоснование

*   **Соответствие "Absurdly Ideal Code":** Этот подход обеспечивает максимальную **Простоту** и **Читаемость** за счет четкого разделения ответственности. Он позволяет избежать условной логики (`if db == 'oracle'`) в коде приложения.
*   **Надежность:** Изоляция предотвращает случайные "кросс-загрязнения" между SQL-диалектами. Развертывание для каждой СУБД становится независимым и предсказуемым.
*   **Производительность:** Позволяет применять специфичные для каждой СУБД оптимизации (индексы, материализованные представления и т.д.) без усложнения общей кодовой базы.
*   **Масштабируемость:** Структура легко расширяется для поддержки других СУБД в будущем (например, PostgreSQL) путем добавления нового каталога `postgres/`.

## Последствия

*   Процесс непрерывной интеграции (CI) должен быть настроен для запуска полного набора тестов для каждой поддерживаемой СУБД.
*   Слой приложения должен максимально полагаться на абстракции, предоставляемые Django ORM, и избегать написания "сырого" SQL-кода, специфичного для конкретной СУБД, за пределами изолированных каталогов.
*   Разработчики должны поддерживать в актуальном состоянии документацию в соответствующей директории (`sql/docs/` или `oracle/docs/`).
