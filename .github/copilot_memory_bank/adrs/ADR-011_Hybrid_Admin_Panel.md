# ADR-011: Гибридная модель администрирования (Hybrid Admin Panel)

## Статус

Принято (2025-10-18)

## Контекст

В технологическом стеке проекта присутствуют два инструмента, которые могут выполнять функции администрирования данных: Django (со встроенной панелью `django.contrib.admin`) и Directus (как Headless CMS, подключенный к той же базе данных). Возникает архитектурный вопрос об их совместном использовании, чтобы избежать конфликтов и соответствовать философии AIC, в частности принципу минимализма.

## Рассмотренные варианты

1.  **Использовать только Django Admin:** Отказаться от Directus. Это упрощает стек, но лишает проект опыта работы с современной Headless CMS и ее преимуществ в UI для контент-менеджеров.
2.  **Использовать только Directus:** Отказаться от Django Admin. Это создает огромный риск обхода бизнес-логики, реализованной в Django, так как Directus работает с базой данных напрямую. Воспроизведение этой логики в Directus (через хуки/потоки) привело бы к колоссальной сложности и хрупкости системы.
3.  **Гибридный подход:** Использовать оба инструмента, но с четким разделением обязанностей.

## Принятое решение

Выбран **Вариант 3 (Гибридный подход)**.

*   **Directus** назначается основной системой для управления **контентом** (Content Management). Сюда относятся сущности, изменение которых не требует сложной, каскадной бизнес-логики: товары, категории, атрибуты, описания, медиафайлы, статьи.

*   **Django Admin** назначается **служебной панелью** для управления **операционными данными** (Operational Management). Сюда относятся сущности, изменение которых тесно связано с бизнес-логикой, реализованной в Django: управление статусами заказов, проведение платежей, управление пользователями и их правами.

## Обоснование

Это решение является прагматичным применением философии AIC, где принципы **Надежности** и **Простоты рабочего процесса** ставятся выше формального минимализма в количестве инструментов.

*   **Надежность:** Мы полностью исключаем риск нарушения бизнес-правил и целостности данных, так как все критические операции проводятся через Django Admin, который неразрывно связан с кодом бизнес-логики.
*   **Простота:** Мы используем "лучший инструмент для конкретной задачи". Directus предоставляет превосходный UI для контент-менеджеров, а Django Admin — проверенный и надежный интерфейс для разработчиков и администраторов системы.
*   **Минимизация сложности:** Мы избегаем скрытой сложности, которая возникла бы при попытке заставить один инструмент выполнять несвойственные ему задачи.

## Последствия

*   Необходимо четко разграничить права доступа для пользователей в обеих системах.
*   Команда разработки должна быть проинструктирована о разделении обязанностей между двумя панелями.
*   Directus должен быть настроен в режиме "только чтение" для операционных таблиц (например, `Orders`), если это возможно, чтобы предотвратить случайные изменения.
